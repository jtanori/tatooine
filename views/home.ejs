<% layout('./layouts/' + LAYOUT) -%>
<% script('/javascripts/lodash.min.js') -%>
<% script('/javascripts/backbone.js') -%>
<% script('//www.parsecdn.com/js/parse-1.3.4.min.js') -%>
<% script('//maps.google.com/maps/api/js?v=3&sensor=false&key=AIzaSyDErD0SmoSczDbedVgFhTdamYStKYU1mXM&language=es') -%>
<% script('//crypto-js.googlecode.com/svn/tags/3.0.2/build/rollups/md5.js') -%>

<% if(LAYOUT === 'phones') { %>
<% script('/javascripts/app-phones.js') -%>
<% } else { %>
<% script('/javascripts/app.js') -%>
<% } %>

<div id="map">
    <div id="map-loader"></div>
</div>

<script>
var globalKeywords = <%- JSON.stringify(data.keywords) %> || [];

<% if(data.venue) { %>

    window.initialVenueConfig = <%- JSON.stringify(data.venue) %>

<% } %>
</script>

<% if(LAYOUT === 'phones') { %>
<div template id="venue-template">
    <div class="ui padded grid" id="venue-preview">
        <div class='row'>
            <div class="four wide column">
                <img src="{{ data.logo }}" class="ui circular bordered tiny image">
            </div>
            {% if(data.phoneNumber){ %}
            <div class="eight wide column">
                <h1 class='ui small header'>{{ data.name }}</h1>
                <p class="venue-card-address"></p>
            </div>
            <div class="four wide column">
                {% if(data.phoneNumber){ %}<a class="ui green fluid button right icon" href="tel:{{ data.phone_number }}" title="Llamar a {{ data.name }}"><i class="call icon"></i></a>{% } %}
            </div>
            {% } else { %}
            <div class="twelve wide column">
                <h1 class='ui small header'>{{ data.name }}</h1>
                <p class="venue-card-address"></p>
            </div>
            {% } %}
        </div>
        <div class="center aligned centered row">
            <div class="five wide column">
                <button class="ui basic icon small compact fluid button venue-card-share">
                    <i class="share icon"></i>
                    <div>Compartir</div>
                </button>
            </div>
            <div class="five wide column">
                <a class="ui basic icon small compact fluid button" href="/venue/{{ data.id }}/details" id="venue-details">
                    <i class="chevron right icon"></i>
                    <div>Detalles</div>
                </a>
            </div>
            <div class="five wide column">
                <button class="ui basic icon small compact fluid button venue-card-directions" id="venue-preview-route">
                    <i class="map icon"></i>
                    <div>Ruta</div>
                </button>
            </div>
        </div>
    </div>
    <div class="venue hidden" id="venue-card">
        <div class="ui card">
            <a class="ui corner orange label" id="venue-card-hide"><i class="close icon"></i></a>
            <div class="image">
                <img src="{{ data.logo }}" id="venue-card-logo">
                <div class="ui large star rating" data-rating="5" data-max-rating="5"></div>
            </div>

            <div class="content">
                <a class="header">{{ data.name }}</a>
                <div class="meta">
                    <span class="date">{{ data.activity }}</span>
                </div>
                <div class="ui divider"></div>
                <div class="ui divided list">
                    <div class="item">
                        <div class="header">Direccion</div>
                        <div class="description venue-card-address" id="venue-card-address"></div>
                    </div>
                </div>
                <div class="ui divider"></div>
                <div class="extra content options">
                    {% if(data.liked){ %}
                        <button class="ui circular small orange button icon" id="venue-card-like" title="Ya no Me Gusta {{ data.name }}"><i class="like icon"></i></button>
                    {% } else { %}
                        <button class="ui circular small button icon" id="venue-card-like" title="Hacer Me Gusta {{ data.name }}"><i class="like icon"></i></button>
                    {% } %}
                    
                    <a class="ui circular small button icon venue-card-share" id="venue-card-share" title="Compartir la tarjeta de {{ data.name }}"><i class="share icon"></i></a>
                    <a class="ui small button icon venue-card-directions" id="venue-card-directions" title="Como llegar a {{ data.name }} desde el punto de origen"><i class="road icon"></i> Ruta</a>
                </div>
                <div id="directions-panel"></div>
            </div>
        </div>
        <div id="venue-options">
            {% if(data.phoneNumber){ %}<a class="ui orange tiny button right icon" href="tel:{{ data.phone_number }}" title="Llamar a {{ data.name }}"><i class="call icon"></i> {{data.phoneNumber}}</a>{% } %}
            {% if(data.url){ %}<a class="ui orange tiny button right icon" target="_blank" href="//{{data.www}}" title="Ir al sitio de {{ data.name }}"><i class="world icon"></i> {{data.www}}</a>{% } %}
            {% if(data.email){ %}<a class="ui orange tiny button right icon" id="venue-options-send-message" title="Enviar mensaje a {{ data.name }}"><i class="send icon"></i> Enviar mensaje</a>{% } %}
            {% if(data.page) { %}
                
                {% if(data.page.facebook) { %}
                <a class="ui facebook button" title="Ver perfil de Facebook de {{ data.name }}"><i class="facebook icon"></i> Facebook</a>
                {% } %}

                <a class="ui black button right icon super loading" title="Ver la RocketPage de {{ data.name }}" id="venue-card-rocket-button"><i class="rocket icon"></i> Ver RocketPage</a>
            {% } %}
        </div>
    </div>
</div>
<% } else { %>
<div template id="venue-template">
    <div id="ui-card-wrapper" class="venue">
        <div class="ui card">
            <div class="image">
                <a class="ui corner orange label"><i class="close icon"></i></a>
                <img src="{{ data.logo }}" id="venue-card-logo">
                <div class="ui large star rating" data-rating="5" data-max-rating="5"></div>
            </div>

            <div class="content">
                <a class="header">{{ data.name }}</a>
                <div class="meta">
                    <span class="date">{{ data.activity }}</span>
                </div>
                <div class="ui divider"></div>
                <div class="ui divided list">
                    <div class="item">
                        <div class="header">Direccion</div>
                        <div class="description venue-card-address" id="venue-card-address"></div>
                    </div>
                </div>
                <div class="ui divider"></div>
                <div class="extra content options">
                    {% if(data.liked){ %}
                        <button class="ui circular small orange button icon" id="venue-card-like" title="Ya no Me Gusta {{ data.name }}"><i class="like icon"></i></button>
                    {% } else { %}
                        <button class="ui circular small button icon" id="venue-card-like" title="Hacer Me Gusta {{ data.name }}"><i class="like icon"></i></button>
                    {% } %}
                    
                    <a class="ui circular small button icon" id="venue-card-share" title="Compartir la tarjeta de {{ data.name }}"><i class="share icon"></i></a>
                    <a class="ui small button icon" id="venue-card-directions" title="Como llegar a {{ data.name }} desde el punto de origen"><i class="road icon"></i> Ruta</a>
                </div>
                <div id="directions-panel"></div>
            </div>
        </div>
        <div id="venue-options">
            {% if(data.phoneNumber){ %}<a class="ui orange tiny button right icon" href="tel:{{ data.phone_number }}" title="Llamar a {{ data.name }}"><i class="call icon"></i> {{data.phoneNumber}}</a>{% } %}
            {% if(data.url){ %}<a class="ui orange tiny button right icon" target="_blank" href="//{{data.www}}" title="Ir al sitio de {{ data.name }}"><i class="world icon"></i> {{data.www}}</a>{% } %}
            {% if(data.email){ %}<a class="ui orange tiny button right icon" id="venue-options-send-message" title="Enviar mensaje a {{ data.name }}"><i class="send icon"></i> Enviar mensaje</a>{% } %}
            {% if(data.page) { %}
                
                {% if(data.page.facebook) { %}
                <a class="ui facebook button" title="Ver perfil de Facebook de {{ data.name }}"><i class="facebook icon"></i> Facebook</a>
                {% } %}

                <a class="ui black button right icon super loading" title="Ver la RocketPage de {{ data.name }}" id="venue-card-rocket-button"><i class="rocket icon"></i> Ver RocketPage</a>
            {% } %}
        </div>
    </div>
</div>
<% } %>

<div template id="venue-videos-template">
    <div class="ui content">
        <div id="venue-videos-list" class="ui list"></div>
    </div>
</div>

<div template id="venue-message-template">
    <div class="header">
        <i class="send icon"></i> Enviar Mensaje
    </div>
    <form class="ui form content">
        <div class="ui field">
            <label>Nombre</label>
            <input type="text" placeholder="Nombre completo" name="message-modal-name">
        </div>
        <div class="ui field">
            <label>Email</label>
            <input type="text" placeholder="Direccion de correo" name="message-modal-email">
        </div>
        <div class="ui field">
            <label>Telefono</label>
            <input type="text" placeholder="Numero de telefono" name="message-modal-phone">
        </div>
        <div class="ui field">
            <label>Mensaje</label>
            <textarea placeholder="Mensaje" name="message-modal-message"></textarea>
        </div>
        <div class="ui checkbox" id="message-modal-contact-wrapper">
            <input type="checkbox" name="message-modal-contact">
            <label>Pueden contactarme por telefono</label>
        </div>
    </form>
    <div class="actions">
        <button type="reset" class="ui dark button cancel"  id="venue-message-modal-cancel">Cancelar</button>
        <button type="submit" class="ui orange button ok"  id="venue-message-modal-ok">Enviar mensaje</button>
    </div>
</div>